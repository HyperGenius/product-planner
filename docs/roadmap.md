# 🚀 Product Roadmap

## 📍 現在地 (Current Status)

* **Backend**: 基本的なCRUD、認証(RLS)、簡易スケジューリングロジック（平日9-17時固定、日またぎ不可）が実装済み。
* **Frontend**: プロジェクト基盤、認証、設備・設備グループ管理画面まで実装済み。

---

## Phase 1: MVP完成 - 基本サイクルの確立 (In Progress)

**目標**: ユーザーが製品を登録し、注文を入力すると、簡易的な納期回答が得られる状態にする。

### 1.1 製品・工程マスタ管理 [Frontend]

* 製品 (`Products`) のCRUD画面実装。
* 工程順序 (`Process Routings`) の編集ダイアログ実装。
* **Status**: 設計済み (Issue 5, 6, 6-1)。

### 1.2 注文登録とシミュレーション [Frontend]

* 注文入力フォームの実装。
* 「シミュレーション実行」ボタンによる納期回答プレビュー表示。
* 注文確定機能。
* **Status**: 設計済み (Issue 7)。

---

## Phase 2: 可視化 - 生産計画の見える化

**目標**: 計算されたスケジュールを視覚的に確認し、全体の流れを把握できるようにする。

### 2.1 スケジュール参照APIの実装 [Backend]

* 指定期間（例：今週、来月）のスケジュールデータを取得するAPI。
* 設備グループごと、オーダーごとのフィルタリング機能。

### 2.2 ガントチャート画面の実装 [Frontend]

* **ライブラリ選定**: `dhtmlx-gantt`, `frappe-gantt`, または自作（SVG/Canvas）。
* **Y軸**: 設備グループ > 設備。
* **X軸**: 日時（タイムライン）。
* **機能**:
* スケジュールバーの表示（製品名・数量）。
* 現在時刻のライン表示。
* 実績入力（着手・完了）への導線（将来用）。



---

## Phase 3: シミュレーションエンジンの高度化 (Realism)

**目標**: 現場の現実に即した、精度の高いスケジュール計算を実現する。

### 3.1 長時間工程（日またぎ）への対応 [Logic]

* **現状**: 8時間を超える工程はエラーになる。17:00を超える作業は翌日に回される。
* **改修**: 作業を「分割（Split）」して割り当てるロジックの実装。
* 例: 10時間の作業 → 1日目[15:00-17:00] (2h) + 2日目[09:00-17:00] (8h)



### 3.2 休憩時間の考慮 [Logic]

* **現状**: 9:00-17:00 ぶっ通しで稼働。
* **改修**: 昼休憩（12:00-13:00）などの「稼働除外時間」を定義し、計算から除外する。

### 3.3 稼働カレンダー機能 [Master/Logic]

* **現状**: 月〜金は稼働、土日は休み（固定）。
* **改修**:
* `work_calendars` テーブルの作成（テナントごと、または設備ごと）。
* 祝日設定、土曜出勤設定、臨時休業の設定。
* ロジック内での `is_workday` 判定をDB参照型に変更。



---

## Phase 4: ダッシュボード & 運用最適化

**目標**: 工場全体の状況を瞬時に把握し、意思決定を支援する。

### 4.1 ダッシュボード画面 [Frontend/Backend]

* **KPI表示**:
* 本日の予定件数 / 完了件数。
* 遅延オーダー数（アラート）。
* 設備稼働率。


* **直近のアクション**:
* 「今日の未着手タスク」リスト。



### 4.2 手動調整機能 (Drag & Drop) [Frontend/Backend]

* ガントチャート上でバーをドラッグして、開始時間をずらしたり設備を変更したりする機能。
* 変更に伴う「再計算（バリデーション）」APIの実装。

---

## 📅 開発優先度 (Priority)

| Feature | Phase | Impact | Complexity |
| --- | --- | --- | --- |
| **製品・工程マスタUI** | 1 | High | Medium |
| **注文シミュレーションUI** | 1 | High | Medium |
| **ガントチャート表示** | 2 | High | High |
| **日またぎ計算ロジック** | 3 | High | High |
| **稼働カレンダー管理** | 3 | Medium | Medium |
| **ダッシュボード** | 4 | Medium | Low |
